<!DOCTYPE html>
<html>
<head>
  <style>
    table, th, td {
        border: 1px solid black;
        text-align: center;
    }
    table {
      table-layout: fixed;
    }
    td {
     width:   50px;
     height:  50px;
    }
  </style>


</head>
<body>

  <p>Tic-Tac-Toe</p>
  <p>Click a square</p>

  <table class="boardStyle" style="width:100px">
    <tr>
      <td class="cell" r=0 c=0><p id="cell00"></p></td>
      <td class="cell" r=0 c=1><p id="cell01"></p></td>
      <td class="cell" r=0 c=2><p id="cell02"></p></td>
    </tr>
    <tr>
      <td class="cell" r=1 c=0><p id="cell10"></p></td>
      <td class="cell" r=1 c=1><p id="cell11"></p></td>
      <td class="cell" r=1 c=2><p id="cell12"></p></td>
    </tr>
    <tr>
      <td class="cell" r=2 c=0><p id="cell20"></p></td>
      <td class="cell" r=2 c=1><p id="cell21"></p></td>
      <td class="cell" r=2 c=2><p id="cell22"></p></td>
    </tr>
  <table>   
   
  <p id="winner"></p>
  
  <button id="reset">Reset</button>

  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    var socket = io();

    $("#reset").click(function(){
      socket.emit('resetBoard');
    });

    $(".cell").click(function(){
      var rc = {row: parseInt($(this).attr("r")) , col: parseInt($(this).attr("c")) };
      socket.emit('clickedSquare', rc);
    });

    socket.on('serverUpdateBoard', function(msg) {
      updateBoard(msg);
    });

    function updateBoard(gameBoard){
      for(r = 0; r < 3; r++){
        for(c = 0; c < 3; c++){
          if( gameBoard.data[r*3 + c] == 0 )
            $("#cell" + r + c).html("X");
          else if( gameBoard.data[r*3 + c] == 1 )
            $("#cell" + r + c).html("O");
          else
            $("#cell" + r + c).html("");
        }
      }

      if( gameBoard.gameOver ) {
        var winner = "Game Over! ";
        switch( gameBoard.winner ) {
          case 0: winner += "X Wins!"; break;
          case 1: winner += "O Wins!"; break;
          default: winner += "Cat's game!"; break;
        }

        $("#winner").html( winner );
      }
      else {
        $("#winner").html("");
      }
    }
  </script>

</body>
</html>

